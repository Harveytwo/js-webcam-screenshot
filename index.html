<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>WebcamScreenshot</title>
<link rel="stylesheet" href="css/webcam-screenshot.css">
</head>
<body>
<form id="options">
	Width: <input type="number" min="1" value="300" required id="width"><br>
	<label><input type="checkbox" id="to-canvas" checked> draw on page</label><br>
	<label><input type="checkbox" id="to-post"> save to server</label><br>
	<div style="visibility: hidden; padding-left: 20px">
		<label>URL: <input type="url" id="to-post-url" required></label><br>
		<label>Field name: <input type="url" id="to-post-fieldname"></label>
	</div>
	<input type="submit">
</form>
<canvas id="canvas" style="dsiplay: none"></canvas>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="js/webcam-screenshot.js"></script>
<script>
$(document).ready(function() {
	if(!WebcamScreenshot.getIsSpported()) {
		alert('Unsupported browser');
	}
	else {
		$('#to-post-url').val(window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port: '') + '/test');
		$('#to-post-fieldname').attr('placeholder', WebcamScreenshot.DEFAULT_POST_FIELDNAME);
		$('#options').on('submit', function() {
			$('#canvas').hide();
			var options = {};
			options.width = parseInt($('#width'), 100) || 300;
			if($('#to-canvas').is(':checked')) {
				options.canvas = $('#canvas');
			}
			if($('#to-post').is(':checked')) {
				options.postTo = $('#to-post-url').val();
				options.postFieldname = $('#to-post-fieldname').val();
			}
			WebcamScreenshot(options, function(rc, result) {
				if(rc !== WebcamScreenshot.RC.OK) {
					if(rc !== WebcamScreenshot.RC.USER_CANCELLED) {
						alert(result);
					}
					return;
				}
				if(options.canvas) {
					$('#canvas').show();
				}
			});
		})
	}
	$('#to-post').on('change', function() {
		var $url = $('#to-post-url');
		if(this.checked) {
			$url.attr('required', 'required').closest('div').css('visibility', 'visible');
		}
		else {
			$url.removeAttr('required').closest('div').css('visibility', 'hidden');
		}
	})
	$('#options').on('submit', function() { return false; })
});
</script>
</body>
</html>